<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>CizaHealth+ | TÃ©lÃ©consultation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --blue:#0a2a5e;
  --bg:#f4f7fb;
  --text:#0a1a2f;
  --radius:22px;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#000;
  color:#fff;
}
.app{
  max-width:430px;
  margin:auto;
  min-height:100vh;
  background:#000;
  display:flex;
  flex-direction:column;
}

/* TOP */
.top{
  padding:16px;
  display:flex;
  justify-content:space-between;
  font-size:13px;
  opacity:.85;
}

/* VIDEO */
.video{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
  opacity:.7;
}

/* CONTROLS */
.controls{
  padding:20px;
  display:grid;
  gap:14px;
  background:#0a0a0a;
}
.mode{
  display:flex;
  gap:10px;
}
.mode button{
  flex:1;
  padding:14px;
  border:none;
  border-radius:16px;
  background:#1b1b1b;
  color:#fff;
  font-weight:600;
}
.mode button.active{
  background:var(--blue);
}
.end{
  background:#8a1f1f;
  padding:16px;
  border:none;
  border-radius:18px;
  color:#fff;
  font-weight:700;
  font-size:15px;
}
</style>

<script>
let request = null;

document.addEventListener("DOMContentLoaded", ()=>{

  request = JSON.parse(localStorage.getItem("activeRequest"));

  if(!request || request.status !== "paid"){
    window.location.href = "dashboard-client.html";
    return;
  }

  document.getElementById("dossier").innerText = request.dossierNumber;
  document.getElementById("pro").innerText =
    request.pro.name + " â€” " + request.pro.role;
});

function selectMode(mode){
  document.getElementById("audio").classList.remove("active");
  document.getElementById("video").classList.remove("active");
  document.getElementById(mode).classList.add("active");

  document.getElementById("screen").innerText =
    mode === "video"
      ? "ðŸ“¹ Consultation vidÃ©o en cours"
      : "ðŸŽ§ Consultation audio en cours";
}

function endCall(){
  // RÃ©sumÃ© mÃ©dical simulÃ©
  const resume = {
    dossierNumber: request.dossierNumber,
    pro: request.pro,
    date: new Date().toLocaleString(),
    conclusion: "Consultation effectuÃ©e avec succÃ¨s.",
    ordonnance: "Prescription envoyÃ©e Ã  la pharmacie partenaire.",
    recommandations: "Repos, hydratation, suivi si nÃ©cessaire."
  };

  // Enregistrement dans lâ€™espace patient
  let records = JSON.parse(localStorage.getItem("medicalRecords")) || [];
  records.push(resume);
  localStorage.setItem("medicalRecords", JSON.stringify(records));

  request.status = "completed";
  localStorage.setItem("activeRequest", JSON.stringify(request));

  window.location.href = "dossier-sante.html";
}
</script>
</head>

<body>

<div class="app">

  <div class="top">
    <div>Dossier : <strong id="dossier">â€”</strong></div>
    <div id="pro">â€”</div>
  </div>

  <div class="video" id="screen">
    ðŸ“¹ Consultation vidÃ©o en cours
  </div>

  <div class="controls">

    <div class="mode">
      <button id="video" class="active" onclick="selectMode('video')">
        ðŸŽ¥ VidÃ©o
      </button>
      <button id="audio" onclick="selectMode('audio')">
        ðŸŽ§ Audio
      </button>
    </div>

    <button class="end" onclick="endCall()">
      Terminer la consultation
    </button>

  </div>

</div>

</body>
</html>
