<script>
document.addEventListener("DOMContentLoaded", () => {

  // üîê SESSION
  const sessionActive = localStorage.getItem("sessionActive");
  const profileRaw = localStorage.getItem("patientProfile");

  // ‚ùå Pas connect√© ‚Üí login
  if (sessionActive !== "true") {
    window.location.replace("login.html");
    return;
  }

  // ‚ùå Pas de profil m√©dical ‚Üí signup
  if (!profileRaw) {
    window.location.replace("signup.html");
    return;
  }

  // ‚úÖ PROFIL OFFICIEL (AUCUN PLACEHOLDER)
  let profile;
  try {
    profile = JSON.parse(profileRaw);
  } catch (e) {
    console.error("Profil corrompu");
    localStorage.removeItem("patientProfile");
    window.location.replace("signup.html");
    return;
  }

  // ‚ùå PROFIL INCOMPLET ‚Üí signup
  if (
    !profile.fullName ||
    !profile.patientId ||
    !profile.age ||
    !profile.province
  ) {
    window.location.replace("signup.html");
    return;
  }

  // ‚úÖ AFFICHAGE DONN√âES R√âELLES
  document.getElementById("fullName").textContent = profile.fullName;
  document.getElementById("age").textContent = profile.age + " ans";
  document.getElementById("province").textContent = profile.province;
  document.getElementById("patientId").textContent = profile.patientId;
});

// üîí D√âCONNEXION (NE SUPPRIME PAS LE PROFIL)
function logout() {
  localStorage.removeItem("sessionActive");
  window.location.replace("index.html");
}
</script>
